 <h1>Vulnerability-Management-Lab</h1>

<h2>Description</h2>
Vulnerability scans are executed on a Windows 10 virtual machine using Tenable's Nessus Essentials tool. The Windows 10 machine is set up with a few different configurations to analyze the differences in scan results. 

<h2>Languages and Utilities Used</h2>

- <b>Nessus Essentials 10.8.1</b> 


<h2>Environments Used </h2>

- <b>VMWare Workstation Pro 17</b>
- <b>Windows 10 Pro</b>



<h2>Project walk-through:</h2>

After Setting Up Windows 10 Pro VM Machine and registering Nessus Essentials we can begin our scans!

We will start with a non credentialed basic network scan.

-->Click New Scan then -->Click Basic Network Scan

![Screenshot 2024-08-25 002439](https://github.com/user-attachments/assets/c63188de-5a19-426d-bb16-72ac6876f552)


![Screenshot 2024-08-25 003213](https://github.com/user-attachments/assets/2f1de274-ba8a-4633-81b5-16110fb18fd5)


We enter a name for the scan and the IP address of our Windows 10 machine --> Click Save.


![Screenshot 2024-08-25 010448](https://github.com/user-attachments/assets/1bdb94f3-94a9-405a-b742-30ed2f7a7294)

In the "My Scans" page, -->Click Launch button to start the created scan.


![Screenshot 2024-08-25 011147](https://github.com/user-attachments/assets/d39240ac-85ca-4cbe-b402-cc15ceeec10f)

Clicking on the row with the labeled scan opens the page with the scan results.


![Screenshot 2024-08-25 202730](https://github.com/user-attachments/assets/78d5a7e3-e88f-426d-b137-5692cdd2e1fc)


Vulnerabilities are listed in categories of risk levels.


![Screenshot 2024-08-25 203352](https://github.com/user-attachments/assets/9337405e-0171-48a0-bc6e-15f60fa3496c)

Clicking on the row will open the page listing the vulnerabilities by their risk levels.

Clicking each vulnerability provides more information such as the description of the vulnerability, the solution for
remediation and an Output message with some information.


![Screenshot 2024-08-25 204742](https://github.com/user-attachments/assets/58e65f47-335c-4498-9e6b-5f5add38aff2)


![Screenshot 2024-08-25 205105](https://github.com/user-attachments/assets/244576f4-85d8-4a3c-a889-722a0f8cb5ad)

Note that the vulnerabilities listed under "Info" are not given risk value but provide some information about the network.

___________________________________________________________________________________________________________________________________________________________

Credentialed Scans

In order to run credentialed scans on the VM we will configure the Windows 10 VM. This done since our machine
is not connected to a domain.

Entering Services.msc in the search bar we will enable remote registry allowing the scan to find any risky configurations.


![Windows 10 -2024-08-25-21-49-55](https://github.com/user-attachments/assets/c770cd48-4f32-4e0e-a167-f5c5554028ab)


![Windows 10 -2024-08-25-21-52-28](https://github.com/user-attachments/assets/9bb46a83-cadf-406d-bde6-7e5bee6b6bcd)

Next, we navigate to User Account Control Settings and change the setting to Never notify for experimental purposes.


![Windows 10 -2024-08-25-22-01-03](https://github.com/user-attachments/assets/9e520667-e960-46a0-831d-1e5b8577d4f9)

We will further disable account controls by navigating to the registry(regedit) and editing a registry key.

Navigate to HKLM-->Software-->Microsoft-->Windows-->CurrentVersion-->Policies-->System

Within System we add D-Word labed "LocalAccountTokenFilterPolicy" and set the value to 1.

![Windows 10 -2024-08-25-22-25-51](https://github.com/user-attachments/assets/a505ff50-aa6d-4734-97c4-a9af116d3289)

In Nessus, we checkmark our previous scan. The More Tab appears. --> Select Configure in the drop down.


![Screenshot 2024-08-25 230429](https://github.com/user-attachments/assets/db371c04-09c9-4d53-94a4-9bbd791e4211)

After changing the scan's name in the settings tab, we click the Credentials tab then Windows to fill in our credentials.
These are our log in credentials into the Windows VM. --> Save


![Screenshot 2024-08-25 231339](https://github.com/user-attachments/assets/5e13d2e7-947c-479c-b054-bcb4b85cf533)



Once the credentialed scan is launched we can see that the vulnerability levels have increased.


![Screenshot 2024-08-29 232149](https://github.com/user-attachments/assets/068d356e-d06c-4917-b995-38dd30cc5226)

Running a credentialed scan detected far greater vulnerabilties than the non credentialed scan. 

Let's take a look at the critical vulnerability and what we would need to do to remediate it.

We Click on Mixed then Critical to find the descripion and solution.

![Screenshot 2024-08-29 233046](https://github.com/user-attachments/assets/33e4387f-ba95-4d04-99fb-3d2d0b9c6a23)

![Screenshot 2024-08-29 233212](https://github.com/user-attachments/assets/d6f77e09-0b59-46a5-ac98-1e2c877ba030)

The vulnerability is a remote code execution vulnerability within the Microsoft 365 Office app version.

![Screenshot 2024-08-29 235022](https://github.com/user-attachments/assets/9488450b-3840-4658-b12c-697b74da4537)

We can resolve the issue by updating the version of the app or uninstalling it.



<img src="https://github.com/4cysec/Active-Directory-Lab/assets/149924544/596577bd-7d05-4f68-9d5a-43fe385ebe21" width="500" height="300" />







